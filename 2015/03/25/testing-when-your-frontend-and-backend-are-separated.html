<!DOCTYPE html><html><head><title>Testing when your frontend and backend are separated</title><link href="/stylesheets/all-84f1eb0e.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-ce68a29a.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta charset='utf-8'><meta content='DockYard.com - How can you run full integration tests when using separate repos?' name='description'><link href='https://plus.google.com/102648938707671188640' rel='author'><meta content='_danmcclain' name='twitter:creator'><meta content='summary' name='twitter:card'><meta content='@DockYard' name='twitter:site'><meta content='http://reefpoints.dockyard.com/2015/03/25/testing-when-your-frontend-and-backend-are-separated.html' name='twitter:url'><meta content='Testing when your frontend and backend are separated' name='twitter:title'><meta content='How can you run full integration tests when using separate repos?' name='twitter:description'><link href='//cloud.typography.com/6496052/702882/css/fonts.css' rel='stylesheet' type='text/css'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/favicon-573a5e34.png' rel='shortcut icon' type='image/x-icon'><link href='/favicon-573a5e34.png' rel='icon' type='image/x-icon'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><link href='/atom.xml' rel='alternate' title='DockYard - Reefpoints' type='application/atom+xml'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                             ..
                                           .O.
                                       .:OO.
                                      :OOO.
                                    :OOO:.
                         ...      :OOOO:
                   ..ZOOOOOOOOO..OZ.O.
                   OOOOOOOOOOOOOOOOI
                  OOOOOOOOOOOOOOOOI,
                 OOOOOOOO. .OOOOOOOO:
                 OOOOOOOO   OOOOOOOOO:
                OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO
                OOOOOO?:   .OOOOOOOOO
               .OOOOO      OOOOOOOOOO
,OO ZO,        OOOOO,     OOOOOOOOOO+
 OOOOO.        OOOOO     OOOOOOOOOOO+
  OOO?        OOOOO     .OOOOOOOOOOO:
   OOO,      OOOOO.    .OOOOOOOOOOOO
    OOOOOOOOOOOOO.    .OOOOOOOOOOOO.
     OOOOOOOOOOOO.  .OOOOOOOOOOOOO.
      8OOOOOOOOOOOOOOOOOOOOOOOODO:
         :OOOOOOOOOOOOOOOOOOOO::

--></head><body class='x2015 x2015_03 x2015_03_25 x2015_03_25_testing-when-your-frontend-and-backend-are-separated'><header><div class='extended-nav-wrap'><div class='l-wrap--wide'><nav class='extended-nav'><a class="extended-nav--logo" data-icon="⌂" href="http://dockyard.com/"><span class='is-hidden'>Home</span></a>
<a class="extended-nav--close" data-icon="X" href="#"><span class='is-hidden'>Close</span></a><div class='extended-nav__items'><div class='extended-nav__items--mobile'><a class="extended-nav__item--work extended-nav__item" href="#">Work</a><nav class='work-nav--mobile'><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong></a></nav></div><a class="extended-nav__item" href="http://dockyard.com/team">Our Team</a><a class="extended-nav__item" href="http://dockyard.com/process">Process</a><a class="extended-nav__item" href="http://dockyard.com/community">Community</a><a class="extended-nav__item active" href="/">Blog</a><a class="extended-nav__item" href="http://dockyard.com/hire-us">Hire Us</a></div></nav><nav class='work-nav'><h6>Selected Work</h6><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong><p>Credit card advice from real people.</p></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong><p>Never pay another penny for smartphone service.</p></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong><p>You should be training. Right now.</p></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong><p>Ask officials questions on city, state, and federal levels.</p></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong><p>How technology helped repeal the #TechTax.</p></a></nav></div></div><nav class='main-nav-wrap'><div class='main-nav l-wrap--wide'><a class="logo" href="http://dockyard.com">DockYard</a><a class="club-sandwich" data-icon="☰" href="#"><span class='is-hidden'>Navigation</span></a></div></nav></header><div class='push--header'></div><div class='l-wrap--blog'><a href="/"><strong class='logo--blog'>ReefPoints</strong><strong class='logo--blog__tagline'>Blog</strong></a><nav class='blog-nav'><a class="blog-nav__item " href="/">Posts</a><a class="blog-nav__item " href="/categories.html">Categories</a><a class="blog-nav__item " href="/authors.html">Authors</a></nav></div><div class='l-wrap--blog__post'><h1 class='post__title'>Testing when your frontend and backend are separated</h1><a class="post__author" href="/authors/dan-mcclain.html">Dan McClain</a><time class='post__date'>March 25<sup>th</sup>, 2015</time><div class='post__content'><p>The last project I worked on was an Ember app that had a Rails backend that was
deployed on Heroku. We had this application as a single repository, where there
were two folders at the root, <code>frontend</code> and <code>backend</code>. This was somewhat easy
to test on Travis-CI; it would check out the one repository, run the Rails
tests, start the Rails server, then run the ember tests that hit the Rails
server. This ended up being a pain to deploy, as when you changed the Rails app,
you were going to redeploy the Ember app, and vice-versa.  It also presented an
issue when deploying to Heroku, as <a href="https://www.youtube.com/watch?v=ceFNLdswFxs&amp;t=4103">we had to utilize <code>git subtree</code> to push
the backend</a>, which
contained the production assets.</p>

<p>With the latest project I started, I&#39;m keeping the backend and the Ember app
separate.  Since the apps are separate, they can be deployed independant of
each other. This made it a little bit harder to run integration tests against
the backend.</p>

<p><strong>Side note:</strong> while you can mock/stub your API in your Ember tests, it is
important to run integration tests against your backend regularly. When you
mock your API, it ends up giving you this false sense of security when it comes
to your Ember app being compatible. Your models may line up perfectly with your
mocks, but your mocks can fall out of date. To prevent this, at least when
running on your continuous integration (CI) server, you should have your Ember
app hit the backend server.</p>

<p>To run end-to-end integration tests on Travis-CI, I added tasks to the
<code>.travis.yml</code> file to clone the backend repository, install dependencies, and
run the server:</p>
<div class="highlight yml "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
34
35
36
37
38
</pre></td>
  <td class="code"><pre><span class="key">language</span>: <span class="string"><span class="content">node_js</span></span>
<span class="key">node_js</span>:
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">0.12</span><span class="delimiter">&quot;</span></span>

<span class="key">sudo</span>: <span class="string"><span class="content">false</span></span>
<span class="key">cache</span>:
  <span class="key">directories</span>:
    - <span class="string"><span class="content">node_modules</span></span>
    - <span class="string"><span class="content">backend</span></span>
    - <span class="string"><span class="content">vendor/bundle</span></span>

<span class="key">before_install</span>:
  - <span class="string"><span class="content">npm config set spin false</span></span>
  - <span class="string"><span class="content">npm install -g npm@^2</span></span>
  <span class="comment"># Select the RVM version</span>
  - <span class="string"><span class="content">rvm use 2.2.1 --install --binary --fuzzy</span></span>
  <span class="comment"># Clone the repository if isn't cloned</span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">[ -d backend/.git ] || git clone git@github.com:&lt;backend-repo&gt; backend</span><span class="delimiter">&quot;</span></span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">cd backend</span><span class="delimiter">&quot;</span></span>
  <span class="comment"># Reset the repo so we can have a conflict-less pull</span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">git reset --hard</span><span class="delimiter">&quot;</span></span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">git clean -f</span><span class="delimiter">&quot;</span></span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">git pull</span><span class="delimiter">&quot;</span></span>
  <span class="comment"># Install dependencies</span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">bundle install --path=../vendor/bundle --jobs=3 --retry=3 --deployment</span><span class="delimiter">&quot;</span></span>
  <span class="comment"># Run the server</span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">RAILS_ENV=test ./bin/rails s &amp;</span><span class="delimiter">&quot;</span></span>
  <span class="comment"># Wait for the Rails app to start</span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">sleep 5</span><span class="delimiter">&quot;</span></span>
  - <span class="string"><span class="delimiter">&quot;</span><span class="content">cd ..</span><span class="delimiter">&quot;</span></span>

<span class="key">install</span>:
  - <span class="string"><span class="content">npm install -g bower</span></span>
  - <span class="string"><span class="content">npm install</span></span>
  - <span class="string"><span class="content">bower install</span></span>

<span class="key">script</span>:
  - <span class="string"><span class="content">npm test</span></span>
</pre></td>
</tr></table>
</div></div>
<p>Note that I cached both the backend and bundle directories to speed up the time
it takes to get the backend running. Since the backend is cached, we only have
to pull the new code.</p>

<p>In this example, we have a Rails app with no database, but it would be pretty
easy to add one. The only other required step was to add an SSH private key to
the Travis settings, since you would have two separate deploy keys. That would
prevent you from cloning the backend repository from the frontend test.  There
should be nothing holding you back from performing end to end tests when you
have separate repositories!</p>
</div><div class='post__share'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2015/03/25/testing-when-your-frontend-and-backend-are-separated.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script><span class='post__share--github'>If you see an issue, please send a <a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/', class='text-link post__issue', target: '_blank'>pull request</a> to contribute.</span></div><div class='related-posts-wrap'><div class='post__avatar-wrap'><img class='post__avatar' src='/images/team/dan-mcclain.jpg'><h5 class='post__avatar__name'>Dan McClain</h5><h5 class='post__avatar__position headline--sub'>Partner &amp; Developer At DockYard
</h5><nav class='post__avatar__social-links'><a target="_blank" class="post__avatar__social-link--twitter" data-icon="#" href="http://twitter.com/_danmcclain">_danmcclain</a><a target="_blank" class="post__avatar__social-link--github" data-icon="★" href="https://github.com/danmcclain">danmcclain</a></nav></div><div class='related-posts'><h3 class='related-posts__header headline--sub'>Other posts by Dan</h3><a class="related-post" href="/2015/02/12/automating-reefpoints.html"><h2 class='related-post__title'>Automating Reefpoints</h2><p>February 12<sup>th</sup>, 2015</p></a>
<a class="related-post" href="/2015/01/28/bubbling-actions-through-components.html"><h2 class='related-post__title'>Bubbling actions through components</h2><p>January 28<sup>th</sup>, 2015</p></a>
<a class="related-posts-link text-link" href="/authors/dan-mcclain.html">See all 21 posts by Dan</a></div></div><p class='post__tags'><a class="post__tag" href="/categories/ember.html">Ember.js&nbsp;<span class='post__tag__count'>(41)</span></a> <a class="post__tag" href="/categories/testing.html">Testing&nbsp;<span class='post__tag__count'>(9)</span></a></p><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus</a>.</noscript></noscript><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.post__issue').attr('href', newpath);
</script></div><div class='push--footer'></div><footer><div class='l-wrap'><div class='l-footer-group'><h3 class='footer-group__title'>EVENTS</h3><a class="footer__event--wgc" target="_blank" href="http://wickedgoodember.com/">Wicked Good Ember Conf</a><a class="footer__event--ember" target="_blank" href="http://www.meetup.com/Boston-Ember-js/">Boston Ember.js Meetup</a><a class="footer__event--openhack" target="_blank" href="http://openhack.github.io/boston/">OpenHack Boston</a><a class="footer__event--ux" target="_blank" href="http://www.meetup.com/uxboston/">UX Boston Meetup</a><a class="footer__event--swift" target="_blank" href="http://www.meetup.com/Boston-Swift/">Boston Swift</a><a class="footer__event--uxhh" target="_blank" href="http://www.uxhappyhour.com/bos">UX Happy Hour</a></div><div class='l-footer-group'><a href="/"><h3 class='footer-group__title'>BLOG</h3></a>
<a class="footer__post" href="/2015/05/22/begin-with-benchmarking.html"><strong>Begin with Benchmarking</strong><h6 class='footer-desc'>Utilizing design research strategies</h6></a>
<a class="footer__post" href="/2015/05/21/sign-up-for-the-dockyard-newsletter.html"><strong>Sign Up For The DockYard Newsletter</strong><h6 class='footer-desc'></h6></a>
<a class="footer__post" href="/2015/05/20/the-new-dockyard-dot-com.html"><strong>The New DockYard.com</strong><h6 class='footer-desc'></h6></a></div><div class='l-footer-group'><a href="http://dockyard.com/hire-us"><h3 class='footer-group__title'>CONTACT</h3></a><h6 class='footer-desc'>DockYard HQ is located in Boston. Stop in sometime and meet our team!</h6><a class="footer__address" target="_blank" href="http://goo.gl/maps/zBGfn"><h6>DockYard Inc.<br>294 Washington St<br>Suite 1150<br>Boston, MA 02108</h6></a>
<a class="text-link" href="http://dockyard.com/hire-us">Get in touch.</a><div class='social-links--footer'><a target="_blank" data-icon="#" class="social-link" href="https://twitter.com/dockyard"><span class='is-hidden'>Twitter</span></a>
<a target="_blank" data-icon="★" class="social-link" href="https://github.com/dockyard"><span class='is-hidden'>GitHub</span></a>
<a target="_blank" data-icon="✒" class="social-link" href="/atom.xml"><span class='is-hidden'>RSS</span></a></div></div></div></footer><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
