<!DOCTYPE html><html><head><title>Declarative Breadcrumb Navigation in Ember.js</title><link href="/stylesheets/all-84f1eb0e.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-ce68a29a.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta charset='utf-8'><meta content='DockYard.com - ember-crubmly is a simple Component that is placed once in your application, and then generates a dynamic breadcrumb by looking up the current route hierarchy. The addon has a simple declarative API, which makes integration with your app super easy.' name='description'><meta content='sugarpirate_' name='twitter:creator'><meta content='summary' name='twitter:card'><meta content='@DockYard' name='twitter:site'><meta content='http://reefpoints.dockyard.com/2015/06/02/ember-crumbly.html' name='twitter:url'><meta content='Declarative Breadcrumb Navigation in Ember.js' name='twitter:title'><meta content='ember-crubmly is a simple Component that is placed once in your application, and then generates a dynamic breadcrumb by looking up the current route hierarchy. The addon has a simple declarative API, which makes integration with your app super easy.' name='twitter:description'><link href='//cloud.typography.com/6496052/702882/css/fonts.css' rel='stylesheet' type='text/css'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/favicon-573a5e34.png' rel='shortcut icon' type='image/x-icon'><link href='/favicon-573a5e34.png' rel='icon' type='image/x-icon'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><link href='/atom.xml' rel='alternate' title='DockYard - Reefpoints' type='application/atom+xml'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                             ..
                                           .O.
                                       .:OO.
                                      :OOO.
                                    :OOO:.
                         ...      :OOOO:
                   ..ZOOOOOOOOO..OZ.O.
                   OOOOOOOOOOOOOOOOI
                  OOOOOOOOOOOOOOOOI,
                 OOOOOOOO. .OOOOOOOO:
                 OOOOOOOO   OOOOOOOOO:
                OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO
                OOOOOO?:   .OOOOOOOOO
               .OOOOO      OOOOOOOOOO
,OO ZO,        OOOOO,     OOOOOOOOOO+
 OOOOO.        OOOOO     OOOOOOOOOOO+
  OOO?        OOOOO     .OOOOOOOOOOO:
   OOO,      OOOOO.    .OOOOOOOOOOOO
    OOOOOOOOOOOOO.    .OOOOOOOOOOOO.
     OOOOOOOOOOOO.  .OOOOOOOOOOOOO.
      8OOOOOOOOOOOOOOOOOOOOOOOODO:
         :OOOOOOOOOOOOOOOOOOOO::

--></head><body class='x2015 x2015_06 x2015_06_02 x2015_06_02_ember-crumbly'><header><div class='extended-nav-wrap'><div class='l-wrap--wide'><nav class='extended-nav'><a class="extended-nav--logo" data-icon="⌂" href="http://dockyard.com/"><span class='is-hidden'>Home</span></a>
<a class="extended-nav--close" data-icon="X" href="#"><span class='is-hidden'>Close</span></a><div class='extended-nav__items'><div class='extended-nav__items--mobile'><a class="extended-nav__item--work extended-nav__item" href="#">Work</a><nav class='work-nav--mobile'><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong></a></nav></div><a class="extended-nav__item" href="http://dockyard.com/team">Our Team</a><a class="extended-nav__item" href="http://dockyard.com/process">Process</a><a class="extended-nav__item" href="http://dockyard.com/community">Community</a><a class="extended-nav__item active" href="/">Blog</a><a class="extended-nav__item" href="http://dockyard.com/hire-us">Hire Us</a></div></nav><nav class='work-nav'><h6>Selected Work</h6><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong><p>Credit card advice from real people.</p></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong><p>Never pay another penny for smartphone service.</p></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong><p>You should be training. Right now.</p></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong><p>Ask officials questions on city, state, and federal levels.</p></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong><p>How technology helped repeal the #TechTax.</p></a></nav></div></div><nav class='main-nav-wrap'><div class='main-nav l-wrap--wide'><a class="logo" href="http://dockyard.com">DockYard</a><a class="club-sandwich" data-icon="☰" href="#"><span class='is-hidden'>Navigation</span></a></div></nav></header><div class='push--header'></div><div class='l-wrap--blog'><a href="/"><strong class='logo--blog'>ReefPoints</strong><strong class='logo--blog__tagline'>Blog</strong></a><nav class='blog-nav'><a class="blog-nav__item " href="/">Posts</a><a class="blog-nav__item " href="/categories.html">Categories</a><a class="blog-nav__item " href="/authors.html">Authors</a></nav></div><div class='l-wrap--blog__post'><h1 class='post__title'>Declarative Breadcrumb Navigation in Ember.js</h1><a class="post__author" href="/authors/lauren-tan.html">Lauren Tan</a><time class='post__date'>June 2<sup>nd</sup>, 2015</time><div class='post__content'><p>Breadcrumb navigation isn&#39;t a new concept, in fact, it&#39;s usefulness has been endlessly debated about by UX designers all over. Today, I won&#39;t get into the nitty gritty on whether or not your app should include one, but I&#39;d like to share an addon I built for a project I&#39;m working on that required it.</p>

<p>This is a simple Component that is placed once in your application, and then generates a dynamic breadcrumb by looking up the current route hierarchy. The addon has a simple declarative API, which makes integration with your app super easy.</p>

<p>Let&#39;s dive in!</p>

<h2>Demo &amp; Source</h2>

<p><img src="http://i.imgur.com/Sutk1UQ.png" alt="ember-crumbly-demo"></p>

<p>You can take a look at the <a href="http://development.ember-crumbly-demo.divshot.io/">demo app</a> to see ember-crumbly in action. What&#39;s cool about it is how little code it takes to add dynamic breadcrumbs to your app, and how declarative it is. The <a href="https://github.com/poteto/ember-crumbly">source is on GitHub</a>, as always.</p>

<h2>The idea</h2>

<p>We work on many Ember apps at DockYard, and one particular client&#39;s project I was working on called for a very dynamic breadcrumb type UI that would respond to changes in the route and model. Before I started actually implementing it, I sketched my plan on paper to see if I could make it nice and declarative instead of manually setting the breadcrumb on each of those route templates.</p>

<h3>The Ember Container and currentRouteName</h3>

<p>The Component relies mainly on Ember&#39;s container and the current route name. On a high level, the Component is injected with the Application Controller&#39;s <code>currentRouteName</code> prop, then looks up the appropriate route in the Container to check if it has a <code>breadCrumb</code> prop defined. If it does, we display whatever the POJO is, or else we show its route name in the Component.</p>

<h2>Intended usage</h2>

<p>The goal was to have an API as declarative as the following:</p>
<div class="highlight hbs "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>{{bread-crumbs linkable=true outputStyle=&quot;foundation&quot;}}
</pre></td>
</tr></table>
</div></div>
<p>And the route:</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="comment">// foo/route.js</span>
<span class="reserved">export</span> <span class="keyword">default</span> Ember.Route.extend({
  <span class="key">breadCrumb</span>: {
    <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Animals</span><span class="delimiter">'</span></span>
  }
});
</pre></td>
</tr></table>
</div></div>
<p>We also wanted to be able to pass in our own template block too:</p>
<div class="highlight hbs "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre>{{#bread-crumbs linkable=true as |component route|}}
  {{#if route.title}}
    {{route.title}}
  {{else}}
    {{route.foo}} ({{route.bar}}) ... {{route.baz}}
  {{/if}}
{{/bread-crumbs}}
</pre></td>
</tr></table>
</div></div>
<p>Let&#39;s see how we can write a component that does just that using some of Ember&#39;s new features.</p>

<h2>Injecting the Application Controller</h2>

<p>I&#39;ve explained how we inject things in other posts, so I won&#39;t go into detail for the initializer. Ember adds the <a href="http://guides.emberjs.com/v1.10.0/understanding-ember/debugging/#toc_get-current-route-name-path">currentRouteName and currentPath to the Application Controller</a>, so we&#39;ll inject it into our Component so we can extract it.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">function</span> <span class="function">initialize</span>(container, application) {
  application.inject(<span class="string"><span class="delimiter">'</span><span class="content">component:bread-crumbs</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">applicationController</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">controller:application</span><span class="delimiter">'</span></span>);
}

<span class="reserved">export</span> <span class="keyword">default</span> {
  <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">crumbly</span><span class="delimiter">'</span></span>,
  initialize
};
</pre></td>
</tr></table>
</div></div>
<h2>Declaring your variables</h2>

<p>We typically declare our variables and functions used at the top of each file, to make code easier to read and refactor in the future. For ember-crumbly&#39;s <code>bread-crumbs</code> component, we&#39;re using the usual suspects:</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Ember from <span class="string"><span class="delimiter">'</span><span class="content">ember</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> layout from <span class="string"><span class="delimiter">'</span><span class="content">../templates/components/bread-crumbs</span><span class="delimiter">'</span></span>;

const get = Ember.get;
const {
  <span class="key">A</span>: emberArray,
  EnumerableUtils,
  Component,
  Logger,
  computed,
  getWithDefault,
  assert,
  typeOf,
  setProperties
} = Ember;

const {
  classify
} = Ember.String;

const {
  map,
  filter
} = EnumerableUtils;

const {
  warn
} = Logger;
</pre></td>
</tr></table>
</div></div>
<p>You might be wondering why we declare <code>const get = Ember.get;</code> by itself on L4 — currently there are issues with destructuring <code>{ get }</code> and <a href="https://github.com/dockyard/ember-suave/issues/5">bugs in Esprima</a>, so we do it by itself as temporary workaround.</p>

<h2>Component props</h2>

<p>Here we set a bunch of default props for the component.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  layout,
  <span class="key">tagName</span>: <span class="string"><span class="delimiter">'</span><span class="content">ol</span><span class="delimiter">'</span></span>,
  <span class="key">linkable</span>: <span class="predefined-constant">true</span>,
  <span class="key">reverse</span>: <span class="predefined-constant">false</span>,
  <span class="key">classNameBindings</span>: [ <span class="string"><span class="delimiter">'</span><span class="content">breadCrumbClass</span><span class="delimiter">'</span></span> ],
  <span class="key">hasBlock</span>: computed.bool(<span class="string"><span class="delimiter">'</span><span class="content">template</span><span class="delimiter">'</span></span>).readOnly(),
  <span class="key">currentRouteName</span>: computed.readOnly(<span class="string"><span class="delimiter">'</span><span class="content">applicationController.currentRouteName</span><span class="delimiter">'</span></span>)
</pre></td>
</tr></table>
</div></div>
<p>We&#39;ve injected the Application Controller into the component in our initializer, so getting the current route&#39;s name is as simple as setting a computed property macro. We make it <a href="http://emberjs.com/api/classes/Ember.ComputedProperty.html#method_readOnly"><code>readOnly</code></a> so we don&#39;t set it by accident.</p>

<h2>Computing the route hierarchy</h2>

<p>Ember&#39;s <code>currentRouteName</code> prop returns the current route hierarchy separated by periods. For example, if you were on <code>/foo/bar/baz</code>, your route would probably be something like <code>foo.bar.baz.index</code>. Knowing this, the goal would be to split the string by the period, and then working out the route name for each of its parts. With the correct route name, we can then lookup the route on the container and extract the <code>breadCrumb</code> POJO we need for our bread-crumb.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre>routeHierarchy: computed(<span class="string"><span class="delimiter">'</span><span class="content">currentRouteName</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">reverse</span><span class="delimiter">'</span></span>, {
  get() {
    const currentRouteName = getWithDefault(<span class="local-variable">this</span>, <span class="string"><span class="delimiter">'</span><span class="content">currentRouteName</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);

    assert(<span class="string"><span class="delimiter">'</span><span class="content">[ember-crumbly] Could not find a curent route</span><span class="delimiter">'</span></span>, currentRouteName);

    const routeNames = <span class="local-variable">this</span>._splitCurrentRouteName(currentRouteName);
    const filteredRouteNames = <span class="local-variable">this</span>._filterIndexRoutes(routeNames);

    const crumbs = <span class="local-variable">this</span>._lookupBreadCrumb(routeNames, filteredRouteNames);
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">reverse</span><span class="delimiter">'</span></span>) ? crumbs.reverse() : crumbs;
  },

  set() {
    warn(<span class="string"><span class="delimiter">'</span><span class="content">[ember-crumbly] `routeHierarchy` is read only</span><span class="delimiter">'</span></span>);
  }
})
</pre></td>
</tr></table>
</div></div>
<p>You&#39;ll notice straight away that we&#39;re using new Ember computed property syntax here. The new syntax allows you to set both getters and setters on your CP, instead of checking argument length like you used to have to do.</p>

<h2>Figuring out the route name</h2>

<p>First, we split the <code>currentRouteName</code> string into an array, and then filter out any <code>index</code> routes. This is because the string splits into an array with all the parts, so <code>foo/bar/baz</code> would yield <code>[ &#39;foo&#39;, &#39;bar&#39;, &#39;baz&#39;, &#39;index&#39; ]</code>, while we only want the first 3.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre>_splitCurrentRouteName(currentRouteName) {
  <span class="keyword">return</span> currentRouteName.split(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>);
},

_filterIndexRoutes(routeNames) {
  <span class="keyword">return</span> filter(routeNames, (name) =&gt; {
    <span class="keyword">return</span> name !== <span class="string"><span class="delimiter">'</span><span class="content">index</span><span class="delimiter">'</span></span>;
  });
}
</pre></td>
</tr></table>
</div></div>
<p>Now with the array of parts, we need to piece them together again bit by bit to reconstruct their constituent routes.</p>

<h2>Looking up the route on the container</h2>

<p>In here, we:</p>

<ol>
<li>Map over the filtered route names individually</li>
<li>Reconstruct the route name by slicing the original array of route names with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice">right <code>end</code> argument</a></li>
<li>Look the reconstructed route name up on the container</li>
<li>Retrieve the breadCrumb POJO, add props to it, and return an Ember Array that our component can iterate over in its template</li>
</ol>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
</pre></td>
  <td class="code"><pre>_lookupBreadCrumb(routeNames, filteredRouteNames) {
  const defaultLinkable = get(<span class="local-variable">this</span>, <span class="string"><span class="delimiter">'</span><span class="content">linkable</span><span class="delimiter">'</span></span>);
  const breadCrumbs = map(filteredRouteNames, (name, index) =&gt; {
    const path = <span class="local-variable">this</span>._guessRoutePath(routeNames, name, index);
    let breadCrumb = <span class="local-variable">this</span>._lookupRoute(path).getWithDefault(<span class="string"><span class="delimiter">'</span><span class="content">breadCrumb</span><span class="delimiter">'</span></span>, <span class="predefined-constant">undefined</span>);
    const breadCrumbType = typeOf(breadCrumb);

    <span class="keyword">if</span> (breadCrumbType === <span class="string"><span class="delimiter">'</span><span class="content">undefined</span><span class="delimiter">'</span></span>) {
      breadCrumb = {
        path,
        <span class="key">linkable</span>: defaultLinkable,
        <span class="key">title</span>: classify(name)
      };
    } <span class="keyword">else</span> <span class="keyword">if</span> (breadCrumbType === <span class="string"><span class="delimiter">'</span><span class="content">null</span><span class="delimiter">'</span></span>) {
      <span class="keyword">return</span>;
    } <span class="keyword">else</span> {
      setProperties(breadCrumb, {
        path,
        <span class="key">linkable</span>: breadCrumb.hasOwnProperty(<span class="string"><span class="delimiter">'</span><span class="content">linkable</span><span class="delimiter">'</span></span>) ? breadCrumb.linkable : defaultLinkable
      });
    }

    <span class="keyword">return</span> breadCrumb;
  });

  <span class="keyword">return</span> emberArray(filter(breadCrumbs, (breadCrumb) =&gt; {
    <span class="keyword">return</span> typeOf(breadCrumb) !== <span class="string"><span class="delimiter">'</span><span class="content">undefined</span><span class="delimiter">'</span></span>;
  }));
}
</pre></td>
</tr></table>
</div></div>
<h3>Reconstructing the route name</h3>

<p>Each time map runs in the previous method, we get a single piece of the route name, e.g. <code>bar</code>. We know that its correct route name is <code>foo.bar</code>, so we can slice the original array with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map#Syntax">map&#39;s <code>index</code> argument</a> to piece those bits together. When we start with the first piece (<code>foo</code>), we know that we need to look up <code>foo.index</code> so that we can generate the correct link-to, so we check for that.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre>_guessRoutePath(routeNames, name, index) {
  const routes = routeNames.slice(<span class="integer">0</span>, index + <span class="integer">1</span>);

  <span class="keyword">if</span> (routes.length === <span class="integer">1</span>) {
    <span class="keyword">return</span> <span class="error">`</span><span class="predefined">$</span>{name}.index<span class="error">`</span>;
  } <span class="keyword">else</span> {
    <span class="keyword">return</span> routes.join(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>);
  }
}
</pre></td>
</tr></table>
</div></div>
<p>Now that we have the correct route name for each path, we can look up the actual route object on the Container while we map over the filtered route names.</p>

<h3>Looking up the route on the Container</h3>

<p>The Ember Container (basically how Ember keeps track of all its different objects) isn&#39;t well documented because it is originally intended to be private API. However, many addons and apps make use of it to do certain things, and this one is no exception. There is an <a href="https://github.com/emberjs/rfcs/pull/46">RFC on the table</a> with reforming the Registry and Container, so this might have to be changed in the future. For now, we can still get the Container from the Component, and then use its <code>lookup(&#39;type:name&#39;)</code> method to find the route.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre>_lookupRoute(routeName) {
  const container = get(<span class="local-variable">this</span>, <span class="string"><span class="delimiter">'</span><span class="content">container</span><span class="delimiter">'</span></span>);
  const route = container.lookup(<span class="error">`</span>route:<span class="predefined">$</span>{routeName}<span class="error">`</span>);
  assert(<span class="error">`</span>[ember-crumbly] <span class="error">\</span><span class="error">`</span>route:<span class="predefined">$</span>{routeName}<span class="error">\</span><span class="error">`</span> was not found<span class="error">`</span>, route);

  <span class="keyword">return</span> route;
}
</pre></td>
</tr></table>
</div></div>
<h3>Extracting the breadCrumb POJO</h3>

<p>With the route object in hand, we can then easily extract the <code>breadCrumb</code> POJO we define on our routes.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>let breadCrumb = <span class="local-variable">this</span>._lookupRoute(path).getWithDefault(<span class="string"><span class="delimiter">'</span><span class="content">breadCrumb</span><span class="delimiter">'</span></span>, <span class="predefined-constant">undefined</span>);
const breadCrumbType = typeOf(breadCrumb);

<span class="keyword">if</span> (breadCrumbType === <span class="string"><span class="delimiter">'</span><span class="content">undefined</span><span class="delimiter">'</span></span>) {
  breadCrumb = {
    path,
    <span class="key">linkable</span>: defaultLinkable,
    <span class="key">title</span>: classify(name)
  };
} <span class="keyword">else</span> <span class="keyword">if</span> (breadCrumbType === <span class="string"><span class="delimiter">'</span><span class="content">null</span><span class="delimiter">'</span></span>) {
  <span class="keyword">return</span>;
} <span class="keyword">else</span> {
  setProperties(breadCrumb, {
    path,
    <span class="key">linkable</span>: breadCrumb.hasOwnProperty(<span class="string"><span class="delimiter">'</span><span class="content">linkable</span><span class="delimiter">'</span></span>) ? breadCrumb.linkable : defaultLinkable
  });
}

<span class="keyword">return</span> breadCrumb;
</pre></td>
</tr></table>
</div></div>
<p>In certain scenarios, you might want to opt-out of displaying a specific route in the breadcrumb. We allow that by setting <code>breadCrumb: null</code> inside of that route. If no breadCrumb POJO is found, we set the title to be the route&#39;s capitalized name by default, and if we do find one, we simply add the path and linkable keys to it.</p>

<p>Finally, we return an <a href="http://emberjs.com/api/classes/Ember.html#method_A">Ember Array</a> so that the resulting array is iterable in the template, and filter out any undefined breadcrumbs.</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre><span class="keyword">return</span> emberArray(filter(breadCrumbs, (breadCrumb) =&gt; {
  <span class="keyword">return</span> typeOf(breadCrumb) !== <span class="string"><span class="delimiter">'</span><span class="content">undefined</span><span class="delimiter">'</span></span>;
}));
</pre></td>
</tr></table>
</div></div>
<p>With the logic done, let&#39;s look at our somewhat complicated template to handle all the different uses!</p>

<h3>Template logic</h3>

<p>Because we want to handle both the inline and block form of the Component, as well as the ability to make each route linkable, the template does get a little complicated:</p>
<div class="highlight hbs "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
</pre></td>
  <td class="code"><pre>{{#each routeHierarchy as |route|}}
  &lt;li class={{crumbClass}}&gt;
    {{#if hasBlock}}
      {{#if route.linkable}}
        {{#link-to route.path}}
          {{yield this route}}
        {{/link-to}}
      {{else}}
        {{yield this route}}
      {{/if}}
    {{else}}
      {{#if route.linkable}}
        {{#link-to route.path}}
          {{route.title}}
        {{/link-to}}
      {{else}}
        {{route.title}}
      {{/if}}
    {{/if}}
  &lt;/li&gt;
{{/each}}
</pre></td>
</tr></table>
</div></div>
<p>And that&#39;s done!</p>

<p><em>This post also appears on <a href="https://medium.com/delightful-ui-for-ember-apps/declarative-breadcrumb-navigation-in-ember-js-5908a92a5de3">Medium in longform</a>.</em></p>
</div><div class='post__share'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2015/06/02/ember-crumbly.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script><span class='post__share--github'>If you see an issue, please send a <a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/', class='text-link post__issue', target: '_blank'>pull request</a> to contribute.</span></div><div class='related-posts-wrap'><div class='post__avatar-wrap'><img class='post__avatar' src='/images/team/lauren-tan.jpg'><h5 class='post__avatar__name'>Lauren Tan</h5><h5 class='post__avatar__position headline--sub'>Developer At DockYard
</h5><nav class='post__avatar__social-links'><a target="_blank" class="post__avatar__social-link--twitter" data-icon="#" href="http://twitter.com/sugarpirate_">sugarpirate_</a><a target="_blank" class="post__avatar__social-link--github" data-icon="★" href="https://github.com/poteto">poteto</a></nav></div><div class='related-posts'><h3 class='related-posts__header headline--sub'>Other posts by Lauren</h3><a class="related-post" href="/2015/04/20/ember-in-viewport.html"><h2 class='related-post__title'>Detecting Ember.js Components Entering or Leaving the Viewport</h2><p>April 20<sup>th</sup>, 2015</p></a>
<a class="related-post" href="/2015/04/09/the-importance-of-being-experience-first.html"><h2 class='related-post__title'>The Importance of Being Experience First</h2><p>April 9<sup>th</sup>, 2015</p></a>
<a class="related-posts-link text-link" href="/authors/lauren-tan.html">See all 3 posts by Lauren</a></div></div><p class='post__tags'><a class="post__tag" href="/categories/ember.html">Ember.js&nbsp;<span class='post__tag__count'>(43)</span></a> <a class="post__tag" href="/categories/addon.html">Addon&nbsp;<span class='post__tag__count'>(3)</span></a> <a class="post__tag" href="/categories/javascript.html">JavaScript&nbsp;<span class='post__tag__count'>(18)</span></a></p><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus</a>.</noscript></noscript><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.post__issue').attr('href', newpath);
</script></div><div class='push--footer'></div><footer><div class='l-wrap'><div class='l-footer-group'><h3 class='footer-group__title'>EVENTS</h3><a class="footer__event--wgc" target="_blank" href="http://wickedgoodember.com/">Wicked Good Ember Conf</a><a class="footer__event--ember" target="_blank" href="http://www.meetup.com/Boston-Ember-js/">Boston Ember.js Meetup</a><a class="footer__event--openhack" target="_blank" href="http://openhack.github.io/boston/">OpenHack Boston</a><a class="footer__event--ux" target="_blank" href="http://www.meetup.com/uxboston/">UX Boston Meetup</a><a class="footer__event--swift" target="_blank" href="http://www.meetup.com/Boston-Swift/">Boston Swift</a><a class="footer__event--uxhh" target="_blank" href="http://www.uxhappyhour.com/bos">UX Happy Hour</a></div><div class='l-footer-group'><a href="/"><h3 class='footer-group__title'>BLOG</h3></a>
<a class="footer__post" href="/2015/06/08/a-clean-pattern-for-modal-dialogs.html"><strong>A clean pattern for modal dialogs</strong><h6 class='footer-desc'>The project you are working on has a number of modal dialogs, and the component helper can help</h6></a>
<a class="footer__post" href="/2015/06/02/ember-crumbly.html"><strong>Declarative Breadcrumb Navigation in Ember.js</strong><h6 class='footer-desc'>ember-crubmly is a simple Component that is placed once in your application, and then generates a dynamic breadcrumb by looking up the current route hierarchy. The addon has a simple declarative API, which makes integration with your app super easy.</h6></a>
<a class="footer__post" href="/2015/05/29/announcing-voorhees.html"><strong>Announcing Voorhees</strong><h6 class='footer-desc'>Voorhees is a library for testing Phoenix JSON APIs</h6></a></div><div class='l-footer-group'><a href="http://dockyard.com/hire-us"><h3 class='footer-group__title'>CONTACT</h3></a><h6 class='footer-desc'>DockYard HQ is located in Boston. Stop in sometime and meet our team!</h6><a class="footer__address" target="_blank" href="http://goo.gl/maps/zBGfn"><h6>DockYard Inc.<br>294 Washington St<br>Suite 1150<br>Boston, MA 02108</h6></a>
<a class="text-link" href="http://dockyard.com/hire-us">Get in touch.</a><div class='social-links--footer'><a target="_blank" data-icon="#" class="social-link" href="https://twitter.com/dockyard"><span class='is-hidden'>Twitter</span></a>
<a target="_blank" data-icon="★" class="social-link" href="https://github.com/dockyard"><span class='is-hidden'>GitHub</span></a>
<a target="_blank" data-icon="✒" class="social-link" href="/atom.xml"><span class='is-hidden'>RSS</span></a></div></div></div></footer><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
