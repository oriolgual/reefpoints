<!DOCTYPE html><html><head><title>Magic behind ES6 Generators</title><link href="/stylesheets/all-84f1eb0e.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-ce68a29a.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta charset='utf-8'><meta content='DockYard.com - Overview of ES6 generators' name='description'><meta content='twokul' name='twitter:creator'><meta content='summary' name='twitter:card'><meta content='@DockYard' name='twitter:site'><meta content='http://reefpoints.dockyard.com/2014/03/30/magic_behind_es6_generators.html' name='twitter:url'><meta content='Magic behind ES6 Generators' name='twitter:title'><meta content='Overview of ES6 generators' name='twitter:description'><link href='//cloud.typography.com/6496052/702882/css/fonts.css' rel='stylesheet' type='text/css'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/favicon-573a5e34.png' rel='shortcut icon' type='image/x-icon'><link href='/favicon-573a5e34.png' rel='icon' type='image/x-icon'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><link href='/atom.xml' rel='alternate' title='DockYard - Reefpoints' type='application/atom+xml'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                             ..
                                           .O.
                                       .:OO.
                                      :OOO.
                                    :OOO:.
                         ...      :OOOO:
                   ..ZOOOOOOOOO..OZ.O.
                   OOOOOOOOOOOOOOOOI
                  OOOOOOOOOOOOOOOOI,
                 OOOOOOOO. .OOOOOOOO:
                 OOOOOOOO   OOOOOOOOO:
                OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO
                OOOOOO?:   .OOOOOOOOO
               .OOOOO      OOOOOOOOOO
,OO ZO,        OOOOO,     OOOOOOOOOO+
 OOOOO.        OOOOO     OOOOOOOOOOO+
  OOO?        OOOOO     .OOOOOOOOOOO:
   OOO,      OOOOO.    .OOOOOOOOOOOO
    OOOOOOOOOOOOO.    .OOOOOOOOOOOO.
     OOOOOOOOOOOO.  .OOOOOOOOOOOOO.
      8OOOOOOOOOOOOOOOOOOOOOOOODO:
         :OOOOOOOOOOOOOOOOOOOO::

--></head><body class='x2014 x2014_03 x2014_03_30 x2014_03_30_magic_behind_es6_generators'><header><div class='extended-nav-wrap'><div class='l-wrap--wide'><nav class='extended-nav'><a class="extended-nav--logo" data-icon="⌂" href="http://dockyard.com/"><span class='is-hidden'>Home</span></a>
<a class="extended-nav--close" data-icon="X" href="#"><span class='is-hidden'>Close</span></a><div class='extended-nav__items'><div class='extended-nav__items--mobile'><a class="extended-nav__item--work extended-nav__item" href="#">Work</a><nav class='work-nav--mobile'><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong></a></nav></div><a class="extended-nav__item" href="http://dockyard.com/team">Our Team</a><a class="extended-nav__item" href="http://dockyard.com/process">Process</a><a class="extended-nav__item" href="http://dockyard.com/community">Community</a><a class="extended-nav__item active" href="/">Blog</a><a class="extended-nav__item" href="http://dockyard.com/hire-us">Hire Us</a></div></nav><nav class='work-nav'><h6>Selected Work</h6><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong><p>Credit card advice from real people.</p></a>
<a href="http://dockyard.com/work/scratch" class="work-nav-item"><strong class='work-nav-item__title'>Scratch Wireless</strong><p>Never pay another penny for smartphone service.</p></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong><p>You should be training. Right now.</p></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong><p>Ask officials questions on city, state, and federal levels.</p></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong><p>How technology helped repeal the #TechTax.</p></a></nav></div></div><nav class='main-nav-wrap'><div class='main-nav l-wrap--wide'><a class="logo" href="http://dockyard.com">DockYard</a><a class="club-sandwich" data-icon="☰" href="#"><span class='is-hidden'>Navigation</span></a></div></nav></header><div class='push--header'></div><div class='l-wrap--blog'><a href="/"><strong class='logo--blog'>ReefPoints</strong><strong class='logo--blog__tagline'>Blog</strong></a><nav class='blog-nav'><a class="blog-nav__item " href="/">Posts</a><a class="blog-nav__item " href="/categories.html">Categories</a><a class="blog-nav__item " href="/authors.html">Authors</a></nav></div><div class='l-wrap--blog__post'><h1 class='post__title'>Magic behind ES6 Generators</h1><a class="post__author" href="/authors/alex-navasardyan.html">Alex Navasardyan</a><time class='post__date'>March 30<sup>th</sup>, 2014</time><div class='post__content'><h2>Overview</h2>

<p>The next version of JavaScript (ES6 or ES.next) is going to have a lot of
great features built in that are going to make developer&#39;s life much easier.
<a href="http://wiki.ecmascript.org/doku.php?id=strawman:promises">Promises</a>,
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:modules">Modules</a>,
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:weak_maps">WeakMaps</a>,
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:generators">Generators</a> to name a few. In this
post I want to talk about generators.</p>

<p>Generators are objects that encapsulate suspended execution context. What the heck does it mean?
In other words, generators allow you to pause execution of your code and return a value.</p>

<p>Let&#39;s say you need to write a <code>cubic</code> function (for any given number, calculate a cubic number)
and then print it out.</p>

<p>Code without generators for 10 numbers:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">out</span>(n) {
  console.log(<span class="string"><span class="delimiter">'</span><span class="content">Cubic number:</span><span class="delimiter">'</span></span>, n);
}

<span class="keyword">function</span> *cube(n) {
  n = n * <span class="integer">3</span>;
  out(n);
}

<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++) {
  cube(i);
}
</pre></td>
</tr></table>
</div></div>
<p>Code with ES6 generators for 10 numbers:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> *cube(n) {
  <span class="keyword">var</span> i = <span class="integer">0</span>, j = n;
  <span class="keyword">while</span> (i &lt; n) {
    i++;
    j = j * <span class="integer">3</span>;
    yield j;
  }
}

<span class="keyword">var</span> c = cube(<span class="integer">10</span>);
<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++) {
  console.log(<span class="string"><span class="delimiter">'</span><span class="content">Cubic number:</span><span class="delimiter">'</span></span>, c.next().value);
}
</pre></td>
</tr></table>
</div></div>
<p>Can you spot the difference? Generator represents a sequence of numbers and every time you call
<code>next()</code> it gives you the next number in the sequence (it actually gives you an object back
with two properties: <code>value</code> and <code>done</code>):</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>c.next(); <span class="comment">// =&gt; { value: 3, done: false }</span>
</pre></td>
</tr></table>
</div></div>
<p>Once the limit is reached, generator will return:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>c.next(); <span class="comment">// =&gt; { value: undefined, done: true }</span>
</pre></td>
</tr></table>
</div></div>
<p>Pretty cool, eh?</p>

<p>Note, that generators look <em>just</em> like functions, but with <code>*</code>s:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="comment">// regular function</span>
<span class="keyword">function</span> <span class="function">cube</span>()  {}

<span class="comment">// es6 generator</span>
<span class="keyword">function</span> *cube() {}
</pre></td>
</tr></table>
</div></div>
<p>If you&#39;re a Python developer, generators and <code>yield</code> are not new to you. But it&#39;s a big step forward
for JavaScript.</p>

<h2>For-Of</h2>

<p>The <code>for of</code> loop is a new iteration construct in ES6 which supports generators. This is really for
performance purposes. Instead of returning a full array, you can just return a generator which
lazily gives values back on each iteration. That decreases memory allocation and you can express
infinite data structures (since no array allocation is needed).</p>

<p>A really interesting use case for generators is async operations:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>spawn(<span class="keyword">function</span>() {
  <span class="keyword">var</span> users = yield db.get(<span class="string"><span class="delimiter">'</span><span class="content">users</span><span class="delimiter">'</span></span>);
  <span class="keyword">var</span> posts = yield db.get(<span class="string"><span class="delimiter">'</span><span class="content">posts</span><span class="delimiter">'</span></span>);
});
</pre></td>
</tr></table>
</div></div>
<p><code>spawn</code> is a function in <a href="http://nodejs.org">node.js</a> that allows you to create child processes.
You can read about it <a href="http://nodejs.org/api/child_process.html#child_process_child_process_spawn_command_args_options">here</a>.</p>

<p><code>spawn</code> hands control over the function to the scheduler, which knows that the function will <code>yield</code>
promises and will send the values back as soon as the promises are going to be resolved (fulfilled).</p>

<p>This is really powerful.</p>

<h2>Availability</h2>

<p>If you really want to use this feature, you&#39;re going to have to use transpilers, such as <a href="https://github.com/google/traceur-compiler">Traceur</a>
or <a href="https://github.com/facebook/regenerator">Regenerator</a>. The reason for that is two new language keywords
introduced by ES6 generators: <code>yield</code> and <code>function *</code>. There&#39;s a really good blog post about <a href="http://gu.illau.me/posts/polyfilling-generators/">polyfilling generators</a>
that goes in depth about how transpilers deal with the new syntax.</p>

<p>Native implementations of generators are available in Firefox and Chrome Canary
(you will need to enable <a href="chrome://flags/#enable-javascript-harmony">harmony experimental flag</a>).</p>

<p>I encourage you to play around with the generators and get familiar with the syntax because in couple of
years from now, we all will be writing code using generators (hopefully).</p>

<p>P.S.</p>

<p>Great article about <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/1.7#Generators">ES6 generators</a>.</p>
</div><div class='post__share'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2014/03/30/magic_behind_es6_generators.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script><span class='post__share--github'>If you see an issue, please send a <a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/', class='text-link post__issue', target: '_blank'>pull request</a> to contribute.</span></div><div class='related-posts-wrap'><div class='post__avatar-wrap'><img class='post__avatar' src='/images/team/alex-navasardyan.jpg'><h5 class='post__avatar__name'>Alex Navasardyan</h5><h5 class='post__avatar__position headline--sub'>Developer
</h5><nav class='post__avatar__social-links'><a target="_blank" class="post__avatar__social-link--twitter" data-icon="#" href="http://twitter.com/twokul">twokul</a><a target="_blank" class="post__avatar__social-link--github" data-icon="★" href="https://github.com/twokul">twokul</a></nav></div><div class='related-posts'><h3 class='related-posts__header headline--sub'>Other posts by Alex</h3><a class="related-post" href="/2014/09/22/javascript-performance-for-the-win.html"><h2 class='related-post__title'>JavaScript Performance For The Win</h2><p>September 22<sup>nd</sup>, 2014</p></a>
<a class="related-post" href="/2014/06/15/swift-and-javascript.html"><h2 class='related-post__title'>Swift and JavaScript</h2><p>June 15<sup>th</sup>, 2014</p></a>
<a class="related-posts-link text-link" href="/authors/alex-navasardyan.html">See all 5 posts by Alex</a></div></div><p class='post__tags'><a class="post__tag" href="/categories/javascript.html">JavaScript&nbsp;<span class='post__tag__count'>(19)</span></a> <a class="post__tag" href="/categories/es6.html">ES6&nbsp;<span class='post__tag__count'>(1)</span></a></p><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus</a>.</noscript></noscript><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.post__issue').attr('href', newpath);
</script></div><div class='push--footer'></div><footer><div class='l-wrap'><div class='l-footer-group'><h3 class='footer-group__title'>EVENTS</h3><a class="footer__event--wgc" target="_blank" href="http://wickedgoodember.com/">Wicked Good Ember Conf</a><a class="footer__event--ember" target="_blank" href="http://www.meetup.com/Boston-Ember-js/">Boston Ember.js Meetup</a><a class="footer__event--openhack" target="_blank" href="http://openhack.github.io/boston/">OpenHack Boston</a><a class="footer__event--ux" target="_blank" href="http://www.meetup.com/uxboston/">UX Boston Meetup</a><a class="footer__event--swift" target="_blank" href="http://www.meetup.com/Boston-Swift/">Boston Swift</a><a class="footer__event--uxhh" target="_blank" href="http://www.uxhappyhour.com/bos">UX Happy Hour</a></div><div class='l-footer-group'><a href="/"><h3 class='footer-group__title'>BLOG</h3></a>
<a class="footer__post" href="/2015/06/25/color-1-art-history.html"><strong>Use of color through art history</strong><h6 class='footer-desc'>Part 1 of 4 in the UX color series</h6></a>
<a class="footer__post" href="/2015/06/19/copy-to-clipboard-without-using-flash.html"><strong>Copy to Clipboard Without Using Flash!</strong><h6 class='footer-desc'>"document.execCommand()" has now added support for "copy" in some browsers</h6></a>
<a class="footer__post" href="/2015/06/12/maintaining-session-in-phoenix-integration-tests.html"><strong>Maintaining a session in Phoenix integration tests</strong><h6 class='footer-desc'>Your server has authentication, and you want to be authenticated in your tests</h6></a></div><div class='l-footer-group'><a href="http://dockyard.com/hire-us"><h3 class='footer-group__title'>CONTACT</h3></a><h6 class='footer-desc'>DockYard HQ is located in Boston. Stop in sometime and meet our team!</h6><a class="footer__address" target="_blank" href="http://goo.gl/maps/zBGfn"><h6>DockYard Inc.<br>294 Washington St<br>Suite 1150<br>Boston, MA 02108</h6></a>
<a class="text-link" href="http://dockyard.com/hire-us">Get in touch.</a><div class='social-links--footer'><a target="_blank" data-icon="#" class="social-link" href="https://twitter.com/dockyard"><span class='is-hidden'>Twitter</span></a>
<a target="_blank" data-icon="★" class="social-link" href="https://github.com/dockyard"><span class='is-hidden'>GitHub</span></a>
<a target="_blank" data-icon="✒" class="social-link" href="/atom.xml"><span class='is-hidden'>RSS</span></a></div></div></div></footer><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
